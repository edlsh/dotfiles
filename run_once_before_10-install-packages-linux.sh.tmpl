{{- if eq .chezmoi.os "linux" -}}
#!/bin/bash
# This script runs ONCE on new Linux machines before applying dotfiles

set -eufo pipefail

echo "ğŸš€ Setting up Linux dotfiles environment..."

# ============================================================
# Install Linuxbrew if needed
# ============================================================
if ! command -v brew &>/dev/null; then
    echo "ğŸº Installing Linuxbrew..."
    /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
    eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"
fi

echo "ğŸ“¦ Installing essential packages..."
brew bundle --no-lock --file=/dev/stdin <<EOF
# Shell & Terminal
brew "zsh"
brew "starship"
brew "atuin"
brew "tmux"

# Modern CLI Tools
brew "eza"
brew "bat"
brew "ripgrep"
brew "fd"
brew "fzf"
brew "zoxide"
brew "jq"
brew "yq"

# Development
brew "neovim"
brew "git"
brew "gh"
brew "mise"

# Utilities
brew "btop"
brew "keychain"
EOF

# Install television if available
if brew search television | grep -q "^television$"; then
    brew install television
fi

echo "âœ… Linux package installation complete!"
{{- end }}
